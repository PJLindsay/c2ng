# -*- makefile -*-
#
#  Project Root
#

# This defines the Makefiles we want to make:
GENERATE = Makefile.min Makefile
INCLUDE_Makefile = Rules-unix.mak Settings-unix.mak
INCLUDE_Makefile.min = Rules-mingw.mak

## Configuration
include config.mk
STRIP = strip
RANLIB = :

# Import AFL
include $(CONFIG_C2NG_AFL_DIR)/config.mk
TARGETS += afl
TYPE_afl = prebuilt-lib
LIBDIR_afl := $(CONFIG_C2NG_AFL_DIR)
LIBEXTRA_afl := $(CONFIG_AFL_LIBS)
CXXFLAGS = -I$(CONFIG_C2NG_AFL_DIR) -I. $(CONFIG_C2NG_CXXFLAGS)
LDFLAGS = $(CONFIG_AFL_LDFLAGS) $(CONFIG_C2NG_LDFLAGS)
CXXTESTDIR = $(CONFIG_AFL_CXXTESTDIR)

# Define "all" targets
all: all-sdl-$(CONFIG_C2NG_HAVE_SDL)
all-sdl-yes: all-sdl-no $(OUTPUT_$(PROJECTS_guiapp))
all-sdl-no: $(OUTPUT_$(PROJECTS_app))
MAIN_TARGETS += all all-sdl-yes all-sdl-no

# Define "guiapp" type
begin guiapp
PARENT = app
LIBS_$(NAME) +:= $(CONFIG_C2NG_GUILIBS)
end

# Target definitions
TARGETS += gamelib
FILES_gamelib = game/pcc/accountfolder.cpp game/pcc/accountfolder.hpp \
    game/pcc/gamefolder.cpp game/pcc/gamefolder.hpp \
    game/pcc/serverdirectory.cpp game/pcc/serverdirectory.hpp \
    game/pcc/browserhandler.cpp game/pcc/browserhandler.hpp \
    game/interface/globalcommands.cpp game/interface/globalcommands.hpp \
    game/interface/simpleprocedure.cpp game/interface/simpleprocedure.hpp \
    game/historyturnlist.cpp game/historyturnlist.hpp game/historyturn.cpp \
    game/historyturn.hpp util/backupfile.cpp util/backupfile.hpp \
    game/map/objectlist.cpp game/map/objectlist.hpp \
    game/map/objectreference.cpp game/map/objectreference.hpp \
    game/nu/turnloader.cpp game/nu/turnloader.hpp \
    game/nu/specificationloader.cpp game/nu/specificationloader.hpp \
    game/nu/gamestate.cpp game/nu/gamestate.hpp game/nu/registrationkey.cpp \
    game/nu/registrationkey.hpp game/nu/stringverifier.cpp \
    game/nu/stringverifier.hpp game/nu/gamefolder.cpp game/nu/gamefolder.hpp \
    game/nu/accountfolder.cpp game/nu/accountfolder.hpp \
    game/interface/minefieldfunction.cpp \
    game/interface/minefieldfunction.hpp game/interface/minefieldcontext.cpp \
    game/interface/minefieldcontext.hpp game/interface/minefieldproperty.cpp \
    game/interface/minefieldproperty.hpp game/map/minefieldtype.cpp \
    game/map/minefieldtype.hpp game/map/minefield.cpp game/map/minefield.hpp \
    game/interface/playerfunction.cpp game/interface/playerfunction.hpp \
    game/interface/playercontext.cpp game/interface/playercontext.hpp \
    game/interface/torpedofunction.cpp game/interface/torpedofunction.hpp \
    game/interface/torpedocontext.cpp game/interface/torpedocontext.hpp \
    game/spec/torpedo.cpp game/spec/torpedo.hpp \
    game/interface/hullfunction.cpp game/interface/hullfunction.hpp \
    game/interface/hullcontext.cpp game/interface/hullcontext.hpp \
    game/interface/hullproperty.cpp game/interface/hullproperty.hpp \
    game/interface/beamfunction.cpp game/interface/beamfunction.hpp \
    game/interface/beamcontext.cpp game/interface/beamcontext.hpp \
    game/interface/enginefunction.cpp game/interface/enginefunction.hpp \
    game/interface/enginecontext.cpp game/interface/enginecontext.hpp \
    game/interface/engineproperty.cpp game/interface/engineproperty.hpp \
    game/interface/weaponproperty.cpp game/interface/weaponproperty.hpp \
    game/interface/componentproperty.cpp \
    game/interface/componentproperty.hpp \
    interpreter/exporter/htmlexporter.cpp \
    interpreter/exporter/htmlexporter.hpp \
    game/interface/userinterfacepropertystack.cpp \
    game/interface/userinterfacepropertystack.hpp game/extracontainer.cpp \
    game/extraidentifier.hpp game/extracontainer.hpp \
    game/map/rendererlistener.hpp game/map/renderer.cpp \
    game/map/viewport.cpp game/map/viewport.hpp game/map/renderoptions.cpp \
    game/map/renderoptions.hpp game/map/renderlist.cpp \
    game/map/renderlist.hpp game/map/renderer.hpp game/teamsettings.cpp \
    game/teamsettings.hpp game/interface/ionstormfunction.cpp \
    game/interface/ionstormfunction.hpp game/interface/ionstormcontext.cpp \
    game/interface/ionstormcontext.hpp game/interface/ionstormproperty.cpp \
    game/interface/ionstormproperty.hpp game/tables/ionstormclassname.cpp \
    game/tables/ionstormclassname.hpp game/tables/wormholestabilityname.cpp \
    game/tables/wormholestabilityname.hpp \
    game/tables/mineraldensityclassname.cpp \
    game/tables/mineraldensityclassname.hpp game/tables/headingname.cpp \
    game/tables/headingname.hpp game/map/ionstormtype.cpp \
    game/map/ionstormtype.hpp game/map/ionstorm.cpp game/map/ionstorm.hpp \
    game/interface/globalfunctions.cpp game/interface/globalfunctions.hpp \
    game/interface/iteratorprovider.hpp game/interface/objectcommand.cpp \
    game/interface/objectcommand.hpp game/interface/iteratorcontext.cpp \
    game/interface/iteratorcontext.hpp game/map/objectobserver.cpp \
    game/map/objectobserver.hpp game/interface/richtextfunctions.cpp \
    game/interface/richtextfunctions.hpp game/interface/richtextvalue.cpp \
    game/interface/richtextvalue.hpp game/interface/simplefunction.cpp \
    game/interface/simplefunction.hpp game/stringverifier.cpp \
    game/v3/stringverifier.cpp game/v3/stringverifier.hpp \
    game/stringverifier.hpp game/interface/userinterfacepropertyaccessor.hpp \
    game/map/cursors.cpp game/map/cursors.hpp \
    game/map/simpleobjectcursor.cpp game/map/simpleobjectcursor.hpp \
    game/map/objectcursor.cpp game/map/objectcursor.hpp util/keystring.cpp \
    util/keystring.hpp game/spec/basecomponentvector.cpp \
    game/spec/basecomponentvector.hpp game/interface/shipfunction.cpp \
    game/interface/shipfunction.hpp game/interface/shipcontext.cpp \
    game/interface/shipcontext.hpp game/interface/shipproperty.cpp \
    game/interface/shipproperty.hpp util/slaverequestsender.hpp \
    util/baseslaverequestsender.hpp util/baseslaverequest.hpp \
    util/slaveobject.hpp util/slaverequest.hpp game/browser/handlerlist.cpp \
    game/browser/handlerlist.hpp game/msg/inbox.cpp game/msg/inbox.hpp \
    game/msg/mailbox.hpp game/exception.cpp game/exception.hpp \
    game/browser/session.cpp game/browser/session.hpp \
    game/browser/usercallbackproxy.cpp game/browser/usercallbackproxy.hpp \
    util/rich/parser.cpp util/rich/parser.hpp game/nu/browserhandler.cpp \
    game/nu/browserhandler.hpp game/browser/usercallback.hpp \
    game/browser/unsupportedaccountfolder.cpp \
    game/browser/unsupportedaccountfolder.hpp util/rich/linkattribute.cpp \
    util/rich/linkattribute.hpp util/rich/styleattribute.cpp \
    util/rich/styleattribute.hpp util/skincolor.cpp util/skincolor.hpp \
    util/rich/colorattribute.cpp util/rich/colorattribute.hpp \
    util/rich/visitor.cpp util/rich/visitor.hpp util/rich/text.cpp \
    util/rich/text.hpp util/rich/attribute.hpp util/profiledirectory.cpp \
    util/profiledirectory.hpp game/browser/accountmanager.cpp \
    game/browser/account.cpp game/browser/account.hpp \
    game/browser/accountmanager.hpp util/requestthread.cpp \
    util/requestthread.hpp game/browser/directoryhandler.cpp \
    game/browser/directoryhandler.hpp game/browser/handler.hpp \
    game/browser/filesystemrootfolder.cpp \
    game/browser/filesystemrootfolder.hpp game/browser/rootfolder.cpp \
    game/browser/rootfolder.hpp game/browser/filesystemfolder.cpp \
    game/browser/filesystemfolder.hpp game/browser/browser.cpp \
    game/browser/folder.hpp game/browser/browser.hpp \
    util/requestreceiver.hpp util/requestsender.hpp util/request.hpp \
    util/requestdispatcher.hpp game/score/compoundscore.cpp \
    game/score/compoundscore.hpp game/score/scoreid.hpp \
    game/score/turnscorelist.cpp game/score/turnscorelist.hpp \
    game/score/turnscore.cpp game/score/turnscore.hpp game/extra.hpp \
    game/interface/playerproperty.cpp game/interface/playerproperty.hpp \
    interpreter/exporter/jsonexporter.cpp \
    interpreter/exporter/jsonexporter.hpp \
    interpreter/exporter/textexporter.cpp \
    interpreter/exporter/textexporter.hpp \
    interpreter/exporter/dbfexporter.cpp \
    interpreter/exporter/dbfexporter.hpp util/constantanswerprovider.cpp \
    util/constantanswerprovider.hpp \
    interpreter/exporter/separatedtextexporter.cpp \
    interpreter/exporter/separatedtextexporter.hpp \
    interpreter/exporter/exporter.cpp interpreter/exporter/exporter.hpp \
    util/answerprovider.hpp interpreter/exporter/fieldlist.cpp \
    interpreter/exporter/fieldlist.hpp interpreter/processlist.cpp \
    interpreter/processlist.hpp game/interface/globalcontext.cpp \
    game/interface/globalcontext.hpp game/interface/globalproperty.cpp \
    game/interface/globalproperty.hpp game/interface/planetfunction.cpp \
    game/interface/planetfunction.hpp game/interface/planetcontext.cpp \
    game/interface/planetcontext.hpp interpreter/objectpropertyvector.cpp \
    interpreter/objectpropertyvector.hpp game/tables/basemissionname.cpp \
    game/tables/basemissionname.hpp game/interface/baseproperty.cpp \
    game/interface/baseproperty.hpp game/map/historyshiptype.cpp \
    game/map/historyshiptype.hpp game/map/playedshiptype.cpp \
    game/map/playedshiptype.hpp game/map/anyshiptype.cpp \
    game/map/anyshiptype.hpp game/tables/happinesschangename.cpp \
    game/tables/happinesschangename.hpp game/map/planetformula.cpp \
    game/map/planetformula.hpp game/map/shiphistorydata.cpp \
    game/map/shiphistorydata.hpp game/map/shipdata.cpp game/map/ship.cpp \
    game/map/shipdata.hpp game/map/ship.hpp game/spec/missionlist.cpp \
    game/spec/missionlist.hpp game/spec/mission.cpp game/spec/mission.hpp \
    game/shipbuildorder.cpp game/shipbuildorder.hpp \
    game/tables/mineralmassclassname.cpp \
    game/tables/mineralmassclassname.hpp game/tables/happinessname.cpp \
    game/tables/happinessname.hpp game/tables/temperaturename.cpp \
    game/tables/temperaturename.hpp game/tables/industrylevel.cpp \
    game/tables/industrylevel.hpp game/tables/nativegovernmentname.cpp \
    game/tables/nativegovernmentname.hpp game/tables/nativeracename.cpp \
    game/tables/nativeracename.hpp interpreter/closure.cpp \
    interpreter/closure.hpp interpreter/hashvalue.cpp \
    interpreter/hashdata.cpp interpreter/hashdata.hpp \
    interpreter/hashvalue.hpp game/interface/planetproperty.cpp \
    game/interface/planetproperty.hpp interpreter/savevisitor.cpp \
    interpreter/savevisitor.hpp interpreter/tagnode.hpp \
    interpreter/savecontext.hpp game/session.cpp game/session.hpp \
    game/game.cpp game/game.hpp game/unitscoredefinitionlist.cpp \
    game/unitscoredefinitionlist.hpp game/unitscorelist.cpp \
    game/unitscorelist.hpp interpreter/selectionexpression.cpp \
    interpreter/selectionexpression.hpp interpreter/filecommandsource.cpp \
    interpreter/filecommandsource.hpp interpreter/filevalue.cpp \
    interpreter/filevalue.hpp interpreter/subroutinevalue.cpp \
    interpreter/subroutinevalue.hpp interpreter/memorycommandsource.cpp \
    interpreter/memorycommandsource.hpp interpreter/binaryexecution.cpp \
    interpreter/binaryexecution.hpp interpreter/indexablevalue.cpp \
    interpreter/indexablevalue.hpp interpreter/arguments.cpp \
    interpreter/arguments.hpp interpreter/arrayvalue.cpp \
    interpreter/arrayvalue.hpp interpreter/process.cpp \
    interpreter/structurevalue.cpp interpreter/structurevalue.hpp \
    interpreter/structuretype.cpp interpreter/structuretype.hpp \
    interpreter/basevalue.cpp interpreter/basevalue.hpp \
    interpreter/ternaryexecution.cpp interpreter/ternaryexecution.hpp \
    interpreter/keymapvalue.cpp interpreter/keymapvalue.hpp \
    interpreter/unaryexecution.cpp interpreter/unaryexecution.hpp \
    util/keymaptable.cpp util/keymaptable.hpp util/keymap.cpp \
    util/atomtable.cpp util/atomtable.hpp util/keymap.hpp util/key.cpp \
    util/key.hpp interpreter/singlecontext.cpp interpreter/singlecontext.hpp \
    interpreter/propertyacceptor.cpp interpreter/nametable.cpp \
    interpreter/nametable.hpp interpreter/typehint.hpp \
    interpreter/simplespecialcommand.cpp \
    interpreter/simplespecialcommand.hpp interpreter/specialcommand.hpp \
    interpreter/callablevalue.hpp interpreter/process.hpp \
    interpreter/defaultstatementcompilationcontext.cpp \
    interpreter/defaultstatementcompilationcontext.hpp \
    interpreter/keywords.cpp interpreter/keywords.hpp \
    interpreter/statementcompiler.cpp interpreter/statementcompiler.hpp \
    interpreter/commandsource.cpp interpreter/commandsource.hpp \
    interpreter/statementcompilationcontext.cpp \
    interpreter/statementcompilationcontext.hpp \
    interpreter/contextprovider.hpp interpreter/context.cpp \
    interpreter/propertyacceptor.hpp interpreter/context.hpp \
    game/parser/messageparser.cpp game/parser/messageparser.hpp \
    game/parser/datainterface.hpp game/parser/messagetemplate.cpp \
    game/parser/messagetemplate.hpp game/map/rangeset.cpp \
    game/map/rangeset.hpp game/v3/inboxfile.cpp game/v3/inboxfile.hpp \
    game/parser/messageinformation.cpp game/parser/messageinformation.hpp \
    game/parser/messagevalue.cpp game/parser/messagevalue.hpp \
    game/turnloader.cpp game/v3/loader.cpp game/v3/loader.hpp \
    game/playerbitmatrix.cpp game/playerbitmatrix.hpp game/playerarray.hpp \
    game/v3/resultloader.cpp game/v3/resultloader.hpp game/turnloader.hpp \
    game/turn.cpp game/turn.hpp game/interpreterinterface.hpp \
    interpreter/optimizer.cpp interpreter/optimizer.hpp \
    interpreter/fusion.cpp interpreter/fusion.hpp interpreter/world.cpp \
    interpreter/world.hpp interpreter/values.cpp interpreter/values.hpp \
    interpreter/expr/parser.cpp interpreter/expr/parser.hpp \
    interpreter/expr/builtinfunction.cpp \
    interpreter/expr/builtinfunction.hpp interpreter/ternaryoperation.cpp \
    interpreter/ternaryoperation.hpp interpreter/unaryoperation.cpp \
    interpreter/unaryoperation.hpp interpreter/binaryoperation.cpp \
    interpreter/binaryoperation.hpp interpreter/expr/indirectcallnode.hpp \
    interpreter/expr/indirectcallnode.cpp \
    interpreter/expr/functioncallnode.cpp \
    interpreter/expr/functioncallnode.hpp \
    interpreter/expr/identifiernode.cpp interpreter/expr/identifiernode.hpp \
    interpreter/expr/membernode.hpp interpreter/expr/membernode.cpp \
    interpreter/expr/logicalnode.cpp interpreter/expr/logicalnode.hpp \
    interpreter/expr/conditionalnode.cpp \
    interpreter/expr/conditionalnode.hpp interpreter/expr/sequencenode.cpp \
    interpreter/expr/sequencenode.hpp interpreter/expr/assignmentnode.cpp \
    interpreter/expr/assignmentnode.hpp interpreter/expr/casenode.cpp \
    interpreter/expr/casenode.hpp interpreter/expr/simplenode.cpp \
    interpreter/expr/simplenode.hpp interpreter/expr/simplervaluenode.cpp \
    interpreter/expr/simplervaluenode.hpp interpreter/expr/literalnode.cpp \
    interpreter/expr/literalnode.hpp interpreter/expr/rvaluenode.hpp \
    interpreter/expr/rvaluenode.cpp interpreter/expr/node.cpp \
    interpreter/expr/node.hpp interpreter/compilationcontext.hpp \
    interpreter/bytecodeobject.cpp interpreter/bytecodeobject.hpp \
    interpreter/opcode.cpp interpreter/opcode.hpp util/math.cpp \
    interpreter/error.cpp interpreter/error.hpp interpreter/tokenizer.cpp \
    interpreter/tokenizer.hpp game/config/userconfiguration.cpp \
    game/config/userconfiguration.hpp game/map/anyplanettype.cpp \
    game/map/playedbasetype.cpp game/map/playedbasetype.hpp \
    game/map/anyplanettype.hpp game/map/playedplanettype.cpp \
    game/map/playedplanettype.hpp game/map/objectvectortype.hpp \
    game/map/objecttype.cpp game/map/objecttype.hpp game/map/universe.cpp \
    game/map/objectvector.hpp game/map/configuration.cpp \
    game/map/configuration.hpp game/map/basestorage.cpp \
    game/map/basestorage.hpp game/map/basedata.hpp game/map/planet.cpp \
    game/map/planetdata.hpp game/map/planet.hpp game/types.hpp \
    game/map/universe.hpp game/map/circularobject.cpp \
    game/map/circularobject.hpp game/map/mapobject.cpp \
    game/map/mapobject.hpp game/map/point.cpp game/map/point.hpp \
    game/map/object.cpp game/map/object.hpp game/spec/friendlycodelist.cpp \
    game/spec/friendlycodelist.hpp game/spec/friendlycode.cpp \
    game/spec/friendlycode.hpp game/vcr/classic/database.cpp \
    game/vcr/classic/database.hpp util/math.hpp game/vcr/statistic.cpp \
    game/vcr/statistic.hpp game/vcr/score.cpp game/vcr/score.hpp \
    game/vcr/classic/pvcralgorithm.cpp game/vcr/classic/pvcralgorithm.hpp \
    game/vcr/classic/statustoken.cpp game/vcr/classic/statustoken.hpp \
    game/vcr/classic/hostalgorithm.cpp game/vcr/classic/hostalgorithm.hpp \
    game/vcr/classic/nullvisualizer.cpp game/vcr/classic/nullvisualizer.hpp \
    game/vcr/classic/visualizer.hpp game/vcr/classic/algorithm.cpp \
    game/vcr/classic/algorithm.hpp game/vcr/classic/types.hpp \
    game/vcr/classic/battle.cpp game/vcr/classic/battle.hpp \
    game/spec/standardcomponentnameprovider.cpp \
    game/spec/standardcomponentnameprovider.hpp game/vcr/object.cpp \
    game/vcr/object.hpp game/vcr/battle.hpp game/vcr/database.hpp \
    game/specificationloader.hpp util/consolelogger.cpp \
    util/consolelogger.hpp game/v3/rootloader.cpp game/v3/rootloader.hpp \
    game/v3/directoryscanner.cpp game/v3/directoryscanner.hpp \
    util/randomnumbergenerator.cpp util/randomnumbergenerator.hpp \
    game/v3/turnfile.cpp game/v3/turnfile.hpp game/timestamp.cpp \
    game/timestamp.hpp game/spec/nullcomponentnameprovider.cpp \
    game/spec/nullcomponentnameprovider.hpp \
    game/config/configurationparser.cpp game/config/configurationparser.hpp \
    util/configurationfileparser.cpp util/configurationfileparser.hpp \
    game/playerlist.cpp game/playerlist.hpp game/player.cpp game/player.hpp \
    game/root.cpp game/root.hpp game/spec/hullassignmentlist.cpp \
    game/spec/hullassignmentlist.hpp game/v3/registrationkey.cpp \
    game/v3/registrationkey.hpp game/registrationkey.hpp \
    util/translation.hpp game/hostversion.cpp game/hostversion.hpp \
    game/spec/hullfunctionassignmentlist.cpp \
    game/spec/hullfunctionassignmentlist.hpp game/spec/hull.cpp \
    game/spec/hull.hpp game/config/aliasoption.cpp \
    game/config/aliasoption.hpp game/config/costarrayoption.cpp \
    game/config/costarrayoption.hpp game/config/hostconfiguration.cpp \
    game/config/hostconfiguration.hpp game/limits.hpp \
    game/config/collapsibleintegerarrayoption.hpp \
    game/config/enumvalueparser.cpp game/config/enumvalueparser.hpp \
    game/config/bitsetvalueparser.cpp game/config/bitsetvalueparser.hpp \
    game/config/integerarrayoption.hpp \
    game/config/genericintegerarrayoption.cpp \
    game/config/genericintegerarrayoption.hpp game/config/stringoption.cpp \
    game/config/stringoption.hpp game/config/integeroption.cpp \
    game/config/integeroption.hpp game/config/configuration.cpp \
    game/config/configuration.hpp game/config/booleanvalueparser.cpp \
    game/config/booleanvalueparser.hpp game/config/integervalueparser.cpp \
    game/config/integervalueparser.hpp game/config/valueparser.cpp \
    game/config/valueparser.hpp game/config/configurationoption.cpp \
    game/config/configurationoption.hpp \
    game/spec/modifiedhullfunctionlist.cpp \
    game/spec/modifiedhullfunctionlist.hpp game/spec/hullfunctionlist.cpp \
    game/spec/hullfunctionlist.hpp util/string.cpp util/string.hpp \
    game/spec/hullfunction.cpp game/playerset.cpp game/playerset.hpp \
    game/spec/hullfunction.hpp game/experiencelevelset.cpp \
    game/experiencelevelset.hpp game/spec/basichullfunctionlist.cpp \
    game/spec/basichullfunctionlist.hpp game/spec/basichullfunction.cpp \
    game/spec/basichullfunction.hpp util/fileparser.cpp util/fileparser.hpp \
    game/v3/resultfile.cpp game/v3/resultfile.hpp game/cargospec.cpp \
    game/cargospec.hpp game/v3/specificationloader.cpp \
    game/v3/specificationloader.hpp game/spec/shiplist.cpp \
    game/spec/shiplist.hpp game/v3/structures.hpp \
    game/spec/componentvector.hpp game/spec/engine.cpp game/spec/engine.hpp \
    game/spec/torpedolauncher.cpp game/spec/torpedolauncher.hpp \
    game/spec/beam.cpp game/spec/beam.hpp game/spec/weapon.cpp \
    game/spec/weapon.hpp game/spec/component.cpp game/spec/component.hpp \
    game/spec/componentnameprovider.hpp game/spec/cost.hpp \
    game/spec/cost.cpp game/element.cpp game/element.hpp
TYPE_gamelib = lib
DEPEND_gamelib = afl
PROJ_AUTO += \
    gamelib:game/*.cpp,game/*.hpp,util/*.cpp,util/*.hpp,interpreter/*.cpp,interpreter/*.hpp

TARGETS += guilib
FILES_guilib = client/tiles/shipoverviewtile.cpp \
    client/tiles/shipoverviewtile.hpp client/dialogs/turnlistdialog.cpp \
    client/dialogs/turnlistdialog.hpp client/widgets/turnlistbox.cpp \
    client/widgets/turnlistbox.hpp client/tiles/errortile.cpp \
    client/tiles/errortile.hpp client/tiles/tilefactory.cpp \
    client/tiles/tilefactory.hpp ui/widgets/focusiterator.cpp \
    ui/widgets/focusiterator.hpp client/screens/playerscreen.cpp \
    client/screens/playerscreen.hpp client/screens/controlscreen.cpp \
    client/screens/controlscreen.hpp client/map/widget.cpp \
    client/map/widget.hpp client/map/proxy.cpp client/map/proxy.hpp \
    client/map/renderer.cpp client/map/renderer.hpp \
    client/dialogs/consoledialog.cpp client/dialogs/consoledialog.hpp \
    client/si/outputstate.cpp client/si/outputstate.hpp \
    client/si/inputstate.cpp client/si/inputstate.hpp \
    client/dialogs/objectselectiondialog.cpp \
    client/dialogs/objectselectiondialog.hpp client/objectcursorfactory.hpp \
    gfx/nullengine.cpp gfx/nullengine.hpp \
    client/tiles/selectionheadertile.cpp \
    client/tiles/selectionheadertile.hpp client/si/contextprovider.hpp \
    client/session.cpp client/session.hpp client/objectobserverproxy.cpp \
    client/objectobserverproxy.hpp client/objectobserver.cpp \
    client/objectobserver.hpp client/objectlistener.hpp client/marker.cpp \
    client/marker.hpp client/si/commands.cpp client/si/commands.hpp \
    client/widgets/keymapwidget.cpp client/widgets/keymapwidget.hpp \
    client/si/control.cpp client/si/control.hpp client/si/userside.cpp \
    client/si/usertask.hpp client/si/userside.hpp client/si/scriptside.cpp \
    client/si/requestlink2.hpp client/si/requestlink1.hpp \
    client/si/scriptprocedure.cpp client/si/scriptprocedure.hpp \
    client/si/scriptside.hpp ui/dialogs/messagebox.cpp \
    ui/dialogs/messagebox.hpp ui/rich/statictext.cpp ui/rich/statictext.hpp \
    client/widgets/busyindicator.cpp client/widgets/busyindicator.hpp \
    ui/widgets/tiledpanel.cpp ui/widgets/tiledpanel.hpp \
    ui/widgets/keydispatcher.cpp ui/widgets/keydispatcher.hpp \
    ui/invisiblewidget.cpp ui/invisiblewidget.hpp client/usercallback.cpp \
    client/usercallback.hpp client/screens/browserscreen.cpp \
    client/screens/browserscreen.hpp ui/widgets/richlistbox.cpp \
    ui/rich/imageobject.cpp ui/rich/imageobject.hpp \
    ui/widgets/richlistbox.hpp ui/rich/documentview.cpp \
    ui/rich/documentview.hpp ui/rich/document.cpp ui/rich/blockobject.hpp \
    ui/rich/document.hpp ui/widgets/statictext.cpp ui/widgets/statictext.hpp \
    ui/widgets/inputline.cpp ui/widgets/inputline.hpp \
    ui/widgets/simpleiconbox.cpp ui/widgets/simpleiconbox.hpp \
    ui/widgets/iconbox.cpp ui/widgets/iconbox.hpp ui/group.cpp ui/group.hpp \
    client/widgets/folderlistbox.cpp client/widgets/folderlistbox.hpp \
    ui/eventloop.cpp ui/eventloop.hpp ui/skincolorscheme.cpp \
    ui/skincolorscheme.hpp gfx/clipfilter.cpp gfx/clipfilter.hpp \
    ui/scrollablewidget.cpp ui/widgets/abstractlistbox.cpp \
    ui/widgets/abstractlistbox.hpp ui/scrollablewidget.hpp \
    ui/res/provider.cpp ui/res/directoryprovider.cpp \
    ui/res/directoryprovider.hpp ui/res/manager.cpp ui/res/provider.hpp \
    ui/res/manager.hpp gfx/blit.cpp gfx/blit.hpp ui/res/ccimageloader.cpp \
    ui/res/ccimageloader.hpp ui/res/engineimageloader.cpp \
    ui/res/imageloader.hpp gfx/timerqueue.cpp gfx/timerqueue.hpp \
    gfx/timer.hpp gfx/rgbapixmap.cpp gfx/rgbapixmap.hpp \
    gfx/palettizedpixmap.cpp gfx/palettizedpixmap.hpp \
    gfx/pixmapcanvasimpl.hpp gfx/types.cpp gfx/pixmap.hpp gfx/canvas.cpp \
    gfx/primitives.hpp gfx/point.cpp ui/widgets/button.cpp \
    ui/widgets/button.hpp ui/widgets/abstractbutton.cpp \
    ui/widgets/abstractbutton.hpp ui/window.cpp ui/window.hpp ui/draw.cpp \
    ui/draw.hpp ui/defaultresourceprovider.cpp \
    ui/defaultresourceprovider.hpp gfx/resourceprovider.hpp gfx/fontlist.cpp \
    gfx/fontlist.hpp gfx/fontrequest.cpp gfx/fontrequest.hpp ui/spacer.cpp \
    ui/spacer.hpp ui/layoutablegroup.cpp ui/layoutablegroup.hpp \
    ui/layout/vbox.cpp ui/layout/vbox.hpp ui/layout/axislayout.cpp \
    ui/layout/axislayout.hpp ui/layout/hbox.cpp ui/layout/hbox.hpp \
    ui/layout/manager.hpp ui/colorscheme.cpp ui/colorscheme.hpp \
    gfx/complex.cpp gfx/complex.hpp gfx/sdl/streaminterface.cpp \
    gfx/sdl/streaminterface.hpp gfx/multiclipfilter.cpp \
    gfx/multiclipfilter.hpp gfx/filter.cpp gfx/filter.hpp ui/root.cpp \
    ui/root.hpp ui/simplewidget.cpp ui/simplewidget.hpp ui/layout/info.cpp \
    ui/layout/info.hpp ui/cardgroup.cpp ui/cardgroup.hpp ui/widget.cpp \
    ui/widget.hpp gfx/bitmapfont.cpp gfx/bitmapfont.hpp gfx/bitmapglyph.cpp \
    gfx/bitmapglyph.hpp gfx/font.cpp gfx/font.hpp gfx/nullcolorscheme.cpp \
    gfx/nullcolorscheme.hpp gfx/context.cpp gfx/context.hpp \
    gfx/colorscheme.cpp gfx/colorscheme.hpp gfx/graphicsexception.cpp \
    gfx/graphicsexception.hpp gfx/sdl/engine.cpp gfx/sdl/engine.hpp \
    gfx/eventconsumer.hpp gfx/engine.hpp gfx/sdl/surface.cpp \
    gfx/sdl/surface.hpp gfx/sdl/modetraits.hpp gfx/nullcanvas.cpp \
    gfx/nullcanvas.hpp gfx/types.hpp gfx/canvas.hpp gfx/rectangleset.cpp \
    gfx/rectangleset.hpp gfx/rectangle.cpp gfx/rectangle.hpp gfx/point.hpp \
    gfx/fillpattern.cpp gfx/fillpattern.hpp
TYPE_guilib = lib
DEPEND_guilib = afl
PROJ_AUTO += guilib:gfx/*.cpp,gfx/*.hpp,ui/*.cpp,ui/*.hpp,client/*.cpp,client/*.hpp


# Tools
TARGETS += c2export
FILES_c2export = tools/c2export.cpp
TYPE_c2export = app
DEPEND_c2export = gamelib afl

# Main entry points (GUIs)
TARGETS += c2ng
FILES_c2ng = main/c2ng.cpp
TYPE_c2ng = guiapp
DEPEND_c2ng = guilib gamelib afl

# Testsuite
TARGETS += testsuite
FILES_testsuite = u/t_game_hostversion.cpp u/t_game_experiencelevelset.cpp \
    u/t_game_spec_engine.cpp u/t_game_historyturnlist.cpp \
    u/t_game_element.cpp u/t_game_historyturn.cpp u/t_game_turnloader.cpp \
    u/t_game_registrationkey.cpp u/t_game_specificationloader.cpp \
    u/t_game_timestamp.cpp u/t_util_backupfile.cpp \
    u/t_interpreter_exporter_fieldlist.cpp u/t_interpreter_exporter.hpp \
    u/t_game_map_objectlist.cpp u/t_game_map_objectreference.cpp \
    u/t_ui_widgets_focusiterator.cpp u/t_ui_widgets.hpp \
    u/t_ui_colorscheme.cpp u/t_ui_widget.cpp \
    u/t_client_dialogs_objectselectiondialog.cpp u/t_client_dialogs.hpp \
    u/t_game_game.cpp u/t_game_interface_userinterfacepropertystack.cpp \
    u/t_util_skincolor.cpp u/t_util_math.cpp \
    u/t_util_constantanswerprovider.cpp u/t_util_answerprovider.cpp \
    u/t_game_extraidentifier.cpp u/t_game_extracontainer.cpp \
    u/t_game_map_viewport.cpp u/t_game_map_circularobject.cpp \
    u/t_game_map_mapobject.cpp u/t_game_map_object.cpp \
    u/t_game_tables_basemissionname.cpp u/t_game_teamsettings.cpp \
    u/t_game_tables_ionstormclassname.cpp \
    u/t_game_tables_wormholestabilityname.cpp \
    u/t_game_tables_mineraldensityclassname.cpp \
    u/t_game_tables_headingname.cpp u/t_game_interface_iteratorprovider.cpp \
    u/t_client_objectcursorfactory.cpp u/t_client_si_control.cpp \
    u/t_gfx_eventconsumer.cpp u/t_gfx_nullengine.cpp \
    u/t_client_si_contextprovider.cpp u/t_ui_res_imageloader.cpp \
    u/t_ui_res_manager.cpp u/t_client_objectlistener.cpp u/t_client.hpp \
    u/t_interpreter_keywords.cpp u/t_game_vcr_score.cpp \
    u/t_game_vcr_object.cpp u/t_game_parser_datainterface.cpp \
    u/t_game_interface_richtextfunctions.cpp u/t_game_v3_stringverifier.cpp \
    u/t_game_stringverifier.cpp u/t_client_si_usertask.cpp \
    u/t_client_si_requestlink2.cpp u/t_client_si_requestlink1.cpp \
    u/t_client_si.hpp u/t_game_cargospec.cpp \
    u/t_game_interface_userinterfacepropertyaccessor.cpp \
    u/t_game_interface_userinterfaceproperty.cpp u/t_game_interface.hpp \
    u/t_game_map_objectcursor.cpp u/t_game_types.cpp \
    u/t_game_interpreterinterface.cpp u/t_game_vcr_battle.cpp \
    u/t_game_vcr_database.cpp u/t_game_vcr.hpp \
    u/t_game_vcr_classic_statustoken.cpp u/t_game_vcr_classic_algorithm.cpp \
    u/t_game_vcr_classic_nullvisualizer.cpp \
    u/t_game_vcr_classic_visualizer.cpp \
    u/t_game_spec_componentnameprovider.cpp \
    u/t_game_spec_componentvector.cpp u/t_game_spec_component.cpp \
    u/t_util_keystring.cpp u/t_interpreter_process.cpp \
    u/t_interpreter_processlist.cpp u/t_interpreter_bytecodeobject.cpp \
    u/t_util_slaverequestsender.cpp u/t_util_slaverequest.cpp \
    u/t_util_baseslaverequestsender.cpp u/t_util_baseslaverequest.cpp \
    u/t_util_slaveobject.cpp u/t_game_browser_handlerlist.cpp \
    u/t_game_player.cpp u/t_game_config_configurationoption.cpp \
    u/t_game_config_costarrayoption.cpp u/t_game_msg_mailbox.cpp \
    u/t_game_msg.hpp u/t_game_browser_unsupportedaccountfolder.cpp \
    u/t_ui_invisiblewidget.cpp u/t_game_exception.cpp \
    u/t_gfx_resourceprovider.cpp u/t_ui_rich_imageobject.cpp \
    u/t_util_rich_parser.cpp u/t_ui_rich_blockobject.cpp u/t_ui_rich.hpp \
    u/t_gfx_canvas.cpp u/t_game_browser_account.cpp \
    u/t_util_unicodechars.cpp u/t_util_rich_visitor.cpp \
    u/t_util_rich_attribute.cpp u/t_util_rich_styleattribute.cpp \
    u/t_util_rich_linkattribute.cpp u/t_util_rich_colorattribute.cpp \
    u/t_util_rich_text.cpp u/t_util_rich.hpp u/t_gfx_engine.cpp \
    u/t_util_requestthread.cpp u/t_ui_group.cpp u/t_ui.hpp \
    u/t_game_browser_handler.cpp u/t_game_browser_folder.cpp \
    u/t_game_browser.hpp u/t_ui_res_provider.cpp u/t_ui_res.hpp \
    u/t_gfx_timerqueue.cpp u/t_gfx_timer.cpp u/t_gfx_sdl_engine.cpp \
    u/t_gfx_sdl.hpp u/t_util_requestreceiver.cpp u/t_util_request.cpp \
    u/t_util_requestdispatcher.cpp u/t_gfx_nullcanvas.cpp \
    u/t_interpreter_nametable.cpp u/t_game_tables_happinesschangename.cpp \
    u/t_game_spec_missionlist.cpp u/t_game_tables_mineralmassclassname.cpp \
    u/t_game_tables_happinessname.cpp u/t_game_tables_temperaturename.cpp \
    u/t_game_tables_nativeracename.cpp \
    u/t_game_tables_nativegovernmentname.cpp \
    u/t_game_tables_industrylevel.cpp u/t_game_tables.hpp \
    u/t_interpreter_closure.cpp u/t_interpreter_values.cpp \
    u/t_game_unitscoredefinitionlist.cpp u/t_game_unitscorelist.cpp \
    u/t_interpreter_statementcompiler.cpp \
    u/t_interpreter_expr_builtinfunction.cpp u/t_interpreter_expr_parser.cpp \
    u/t_interpreter_expr.hpp u/t_interpreter.cpp u/t_util_keymaptable.cpp \
    u/t_util_keymap.cpp u/t_util_atomtable.cpp u/t_util_key.cpp \
    u/t_game_parser.hpp u/t_game_parser_messagetemplate.cpp \
    u/t_game_playerbitmatrix.cpp u/t_game.hpp u/t_game_playerarray.cpp \
    u/t_interpreter_tokenizer.cpp u/t_interpreter.hpp \
    u/t_game_spec_friendlycodelist.cpp u/t_game_spec_friendlycode.cpp \
    u/t_game_map_configuration.cpp u/t_game_map_point.cpp u/t_game_map.hpp \
    u/t_game_vcr_classic_pvcralgorithm.cpp u/t_game_vcr_classic.hpp \
    u/t_game_vcr_classic_hostalgorithm.cpp u/t_gfx_rectangle.cpp \
    u/t_gfx_point.cpp u/t_gfx.hpp u/t_gfx_fillpattern.cpp \
    u/t_util_randomnumbergenerator.cpp u/t_util_string.cpp u/t_util.hpp \
    u/t_game_config_valueparser.cpp u/t_game_config_hostconfiguration.cpp \
    u/t_game_config_bitsetvalueparser.cpp \
    u/t_game_config_booleanvalueparser.cpp \
    u/t_game_config_integervalueparser.cpp u/t_game_config.hpp \
    u/t_game_config_configuration.cpp u/t_game_spec_hullfunctionlist.cpp \
    u/t_game_v3_resultfile.cpp u/t_game_v3.hpp testsuite.cpp \
    u/t_game_spec.hpp u/t_game_spec_cost.cpp
TYPE_testsuite = guiapp
DEPEND_testsuite = guilib gamelib afl
PROJ_AUTO += testsuite:u/*.cpp,u/*.hpp

HEADERS_testsuite = u/t_*.hpp

test: $(OUTPUT_testsuite)
	./testsuite

testsuite.cpp: $(HEADERS_testsuite)
	@echo "        Generating test driver..."
	@$(PERL) $(CXXTESTDIR)/cxxtestgen.pl --gui=TestController --have-eh --error-printer -o $@ $(HEADERS_testsuite)

distclean: 
	$(RM) testsuite.cpp

.PHONY: tags
tags: 
	@etags --recurse client game gfx interpreter main tools ui util

# We must define _CXXTEST_HAVE_EH and _CXXTEST_HAVE_STD for test cases,
# but not for testsuite.cpp, where cxxtest automatically defines it.
CXXFLAGS_$(FILES_testsuite) +:= -I$(CXXTESTDIR) -D_CXXTEST_HAVE_EH -D_CXXTEST_HAVE_STD -g
CXXFLAGS_testsuite.cpp +:= -U_CXXTEST_HAVE_EH -U_CXXTEST_HAVE_STD -O0

# Must rename some object files because ar only looks at basenames.
PROJ_UNIQUE_STEMS = 1
